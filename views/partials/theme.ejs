<script>
// Instant theme application - runs before page renders to prevent flash
(function() {
    try {
        const saved = localStorage.getItem('schoology_settings');
        if (saved) {
            const settings = JSON.parse(saved);
            if (settings.darkMode) {
                document.documentElement.classList.add('dark-mode');
            }
            // Apply liquid glass effect (enabled by default)
            if (settings.liquidGlass !== false) {
                document.documentElement.classList.add('liquid-glass');
            }
            // Apply accent color
            const colors = {
                blue: '#0071e3', purple: '#af52de', green: '#34c759',
                orange: '#ff9f0a', red: '#ff3b30', pink: '#ff2d55'
            };
            const hoverColors = {
                blue: '#0077ed', purple: '#c45ee8', green: '#3dd660',
                orange: '#ffaa1f', red: '#ff5044', pink: '#ff4169'
            };
            if (settings.accentColor && colors[settings.accentColor]) {
                document.documentElement.style.setProperty('--accent-primary', colors[settings.accentColor]);
                document.documentElement.style.setProperty('--accent-primary-hover', hoverColors[settings.accentColor]);
            }
        } else {
            // Default: enable liquid glass
            document.documentElement.classList.add('liquid-glass');
        }
    } catch (e) {
        // Default: enable liquid glass on error
        document.documentElement.classList.add('liquid-glass');
    }
})();
</script>

<!-- Vercel Analytics (Express/EJS fallback) -->
<!--
    This repo is an Express/EJS app (not Next.js), so the recommended
    `import { Analytics } from "@vercel/analytics/next"` isn't usable here.
    Instead we add a lightweight client script that enables Vercel's
    analytics collection for non-Next projects. If you later migrate to
    Next.js, move the `import` into your top-level `app` or `_app` file and
    render `<Analytics />` instead.
-->
<script>
    (function() {
        try {
            // Load Vercel analytics client script (non-Next runtime)
            var s = document.createElement('script');
            s.defer = true;
            s.src = 'https://static.vercel.com/analytics/script.js';
            s.onload = function() {
                // Optional: signal that analytics were loaded
                if (window && window.__VERCEL_ANALYTICS_LOADED === undefined) {
                    window.__VERCEL_ANALYTICS_LOADED = true;
                }
            };
            document.head.appendChild(s);
        } catch (e) {
            // ignore failures â€” analytics should be non-blocking
            console.warn('Vercel Analytics failed to load:', e);
        }
    })();
</script>
